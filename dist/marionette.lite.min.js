!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("backbone"),require("backbone.marionette"),require("underscore")):"function"==typeof define&&define.amd?define("marionette-lite",["backbone","backbone.marionette","underscore"],t):"object"==typeof exports?exports["marionette-lite"]=t(require("backbone"),require("backbone.marionette"),require("underscore")):e["marionette-lite"]=t(e.backbone,e["backbone.marionette"],e.underscore)}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheMixin=t.Collection=t.Model=t.Filter=t.View=t.Controller=t.Router=void 0;var n=r(1),i=r(5),o=r(6),u=r(7),c=r(8),l=r(9),s=r(10),a={Router:o.Router,Controller:n.Controller,View:u.View,Filter:i.Filter,Model:c.Model,Collection:l.Collection,CacheMixin:s.CacheMixin};t.default=a,t.Router=o.Router,t.Controller=n.Controller,t.View=u.View,t.Filter=i.Filter,t.Model=c.Model,t.Collection=l.Collection,t.CacheMixin=s.CacheMixin},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var i=r(2),o=n(i),u=r(3),c=n(u),l=r(4),s=n(l),a=c.default.Object.extend({initialize:function(e){this.layout=e.layout},go:function(e){o.default.navigate(e,!0)},changeView:function(e){this.currentView&&s.default.isFunction(this.currentView.close)&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(this.currentView.events),this.layout.showChildView("main",e)}});t.default=a,t.Controller=a},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Filter=void 0;var i=r(3),o=n(i),u="before",c="after",l=o.default.Object.extend({execution:u,name:!1,async:!1,handler:function(e,t,r){return r()}});l.Before=u,l.After=c,t.default=l,t.Filter=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var i=r(2),o=n(i),u=r(3),c=n(u),l=r(4),s=n(l),a=r(5),f=c.default.AppRouter.extend({runFilters:function(e,t,r,n,i){var o=this,u=this._getController(),c=u.filtersMap(),l=c.filter(function(t){return t.execution===e}),a=[];l.map(function(e){var t=u.filters[e.name]||[],n=1===t.length&&"*"===t[0];(n||t.indexOf(r)!==-1&&s.default.isFunction(e.handler)||o.checkRegex(t,r))&&a.push(e)});for(var f=0;f<a.length-1;f++)a[f].handler.bind(r,a[f+1].handler);this.run(a,t,r,n,i)},checkRegex:function(e,t){return!!s.default.find(e,function(e){if(e instanceof RegExp)return RegExp(e).test(t)})},run:function(e,t,r,n,i){var o=this;if(!e.length)return void i.call(t);var u=e[0],c=s.default.tail(e),l=function(){return o.run(c,t,r,n,i)};u.async?u.handler.apply(t,[r,n,l]):u.handler.apply(t,[r,n])!==!1&&l()},route:function(e,t,r){var n=this;s.default.isRegExp(e)||(e=this._routeToRegExp(e)),s.default.isFunction(t)&&(r=t,t=""),r||(r=this[t]);var i=this;return o.default.history.route(e,function(u){var c=i._extractParameters(e,u);n.runFilters(a.Filter.Before,i,u,c,function(){i.execute(r,c,t)!==!1&&(i.trigger.apply(i,["route: "+t].concat(c)),i.trigger("route",t,c),o.default.history.trigger("route",i,t,c),n.runFilters(a.Filter.After,i,u,c,function(){}))})}),this}});t.default=f,t.Router=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var i=r(2),o=(n(i),r(3)),u=n(o),c=r(4),l=(n(c),u.default.View.extend({close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose()}}));t.default=l,t.View=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var i=r(2),o=n(i),u=r(4),c=n(u),l=o.default.Model;l.prototype.fetchPromise=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(r,n){var i=t.success,o=t.error;e.fetch(c.default.defaults({success:function(e,t,n){r("function"==typeof i?i.call(this,e,t,n):e)},error:function(e,t,r){n("function"==typeof o?o.call(this,e,t,r):t)}},t))})},l.prototype.destroyPromise=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(r,n){var i=t.success,o=t.error;e.destroy(c.default.defaults({success:function(e,t,n){r("function"==typeof i?i.call(this,e,t,n):e)},error:function(e,t,r){n("function"==typeof o?o.call(this,e,t,r):t)}},t))})},l.prototype.savePromise=function(e,t){arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}},t.default=l,t.Model=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=void 0;var i=r(2),o=n(i),u=r(8),c=o.default.Collection;c.prototype.fetchPromise=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u.Model.prototype.fetchPromise.call(this,e)},t.default=c,t.Collection=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=n(i),u=r(4),c=n(u),l=r(9),s=r(11),a={cachePrefix:"collection",sync:function(e,t,r){var n=l.Collection.prototype.sync;if("read"!==e&&this.cacheKey){var i=new s.Storage,o=this.cachePrefix+"-"+this.cacheKey;i.remove(o)}return n.apply(this,arguments)},fetch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=l.Collection.prototype.fetch,r=new s.Storage,n=e.success,i=e.cache;if(!this.cacheKey)return t.call(this,e);var u=this.cachePrefix+"-"+this.cacheKey;if((i||this.cacheFetching)&&r.has(u)){var a=r.find(u);return this.set(this.parse(a,e),e),c.default.isFunction(n)&&n(this,a,e),o.default.$.Deferred().resolve()}return e.success=function(e,t,i){r.put(u,t),c.default.isFunction(n)&&n(e,t,i)},t.call(this,e)}};t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0;var i=r(4),o=n(i),u=r(2),c=n(u),l=null,s=function e(){return l instanceof e?l:(l=this,void(this._storage={}))};o.default.extend(s.prototype,c.default.Events,{_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}},put:function(e,t){this.trigger("put",e,t),this._storage[e]=this._serialize(t)},has:function(e){var t="undefined"!=typeof this._storage[e];return this.trigger("has",e,t),t},find:function(e){var t=this._deserialize(this._storage[e]);return this.trigger("find",e,t),t},remove:function(e){var t=this._storage[e];return this.trigger("remove",e,t),delete this._storage[e],"undefined"!=typeof t},clear:function(){this.trigger("clear"),this._storage={}}}),t.default=s,t.Storage=s}])});